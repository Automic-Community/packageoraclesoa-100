*** Settings ***
Documentation     NOTE:
...               Testing Action Using SUDO option
Suite Setup       Setup_suite
Suite Teardown    Teardown_suite
Force Tags        #_action_short_name_#   SUDO     _template_
Default Tags      win    unix
Test Template     #_action_keyword_template_name_#
Resource          prt_keywords.txt
Resource          ../../resources/keywords.txt

*** Test Cases ***    OK_NOK    USE SUDO    SUDO USER         SUDO PASSWORD          AGENT     LOGIN OBJECT            RETURN CODE    RETURN STATUS    MESSAGE
01_Success Execution By Sudoer With Password
                      OK        Sudo        atsudowithpass    atsudowithpass         ${ENV}    ${LOGIN.SUDO}           0              ${ENDED_OK}      Creating temp file to sudo

02_Success Execution By Sudoer Without Password
                      OK        Sudo        atsudonopass      ${EMPTY}               ${ENV}    ${LOGIN.ALL}            0              ${ENDED_OK}      ${EMPTY}

03_Failed Execution By Sudoer Wrong Password
                      NOK       Sudo        atsudowithpass    atsudowithpasswrong    ${ENV}    ${LOGIN.SUDO}           0              ${ENDED_NOK}     incorrect password

04_Failed Execution By Required Pass Sudoer But Not Fill Pass
                      NOK       Sudo        atsudowithpass    ${EMPTY}               ${ENV}    ${LOGIN.SUDO}           0              ${ENDED_NOK}     ERROR: SUDO password is blank
                
*** Keywords ***
#_action_keyword_template_name_#
    #_template_documentation_#
     ...    All inputs are default and valid, except input variables for SUDO promptset.
    ...    Required inputs:
    ...    - ${USE_SUDO}  : Run using sudo password (and sudo username if specfied)
    ...    - ${SUDO_PASS}: Password of sudo user
    ...    - ${SUDO_USER}: Sudo user will be use
    ...    - ${returnCode}: expected return code after execution 
    ...    - ${returnStatus}: expected return status after execution
    ...    - ${message}: expected message contained in report after execution 
    [Arguments]   ${OK_NOK}    ${USE_SUDO}   ${SUDO_USER}   ${SUDO_PASS}    ${AGENT}    ${LOGIN}   ${returnCode}    ${returnStatus}    ${message}
    Run Keyword If    '${_OS}' == 'WIN'    Pass Execution    Deprecated test on Win.    win_deprecated    -regression
    Init Action    #_action_variable_name_#
    Set Siebel DB Connection
    Set Java Properties Promptset
    Action Set    ${PRT_SUDO_UC4RB_USE_SUDO}    ${USE_SUDO}
    Action Set    ${PRT_SUDO_UC4RB_SUDO_USER}    ${SUDO_USER}
    Action Set    ${PRT_SUDO_UC4RB_SUDO_PASSWORD}    ${SUDO_PASS}
    Action Set    ${PROMPTSET_AGENT}    ${AGENT}
    Action Set    ${PROMPTSET_LOGIN}    ${LOGIN}
    Action Set Timeout    500
    Action Execute
    Action Report Should Be Found
    Run Keyword If    '${OK_NOK}'=='OK'    Action Return Code Should Be    ${returnCode}
    Run Keyword If    '${OK_NOK}'=='NOK'    Action Return Code Should Not Equal    ${returnCode}
    Action Return Status Should Be    ${returnStatus}
    Action Report Should Contain    ${header_logging}
    Action Report Should Contain    ${param_logging} 
    Run Keyword If    '${OK_NOK}'=='OK'   Action Report Should Contain    ${execution_logging}    
    Run Keyword If    '${OK_NOK}'=='OK'   Action Report Should Contain    ${message}
    Run Keyword If    '${OK_NOK}'=='OK'    Action Report Should Contain    ${footer_logging_OK}
        
Setup_suite
    [Documentation]    TODO: Write all steps need prepare before testing here
    Log   Start testing SUDO for #_action_keyword_template_name_#
    
Teardown_suite
    [Documentation]    TODO: Write all steps for cleanup after testing here
    Log   Testing SUDO for #_action_keyword_template_name_# end