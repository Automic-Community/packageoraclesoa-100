*** Settings ***
Documentation     NOTE:
...               add note here
Suite Setup       Setup_suite
Suite Teardown    Teardown_suite
Force Tags        DEPLOY_APPLICATION
Default Tags      win    unix
Test Template     Deploy Application Template
Resource          ../../resources/keywords.txt

*** Variables ***
${SAR_LOCATION}    C:\\JDeveloper\\mywork\\Oracle_SOA_Package\\SOAProject\\deploy\\sca_SOAProject.jar
${CONFIG_PLAN}    C:\\JDeveloper\\mywork\\Oracle_SOA_Package\\SOAProject\\SOAProject_cfgplan.xml
${PROTOCOL}       http

*** Test Cases ***    OK_NOK                                                                                Sar Location       Overwrite    Force Default    Config Plan       Partition    Oracle Home    Host           Protocol       RETURN CODE    RETURN STATUS
1. Success deploy application with full arguments and Overwrite is NO
                      #[Setup] will be implement after merge to develop branch with undeploy application
                      OK                                                                                    ${SAR_LOCATION}    NO           YES              ${CONFIG_PLAN}    ${EMPTY}     ${_WL_HOME}    ${_WL_HOST}    ${PROTOCOL}    0              ${ENDED_OK}

2. Success deploy application with full arguments and Overwrite is YES
                      OK                                                                                    ${SAR_LOCATION}    YES          YES              ${CONFIG_PLAN}    ${EMPTY}     ${_WL_HOME}    ${_WL_HOST}    ${PROTOCOL}    0              ${ENDED_OK}

3. Fail deploy application with full arguments and Overwrite is YES
                      NOK                                                                                   ${SAR_LOCATION}    NO           YES              ${CONFIG_PLAN}    ${EMPTY}     ${_WL_HOME}    ${_WL_HOST}    ${PROTOCOL}    50             ${ENDED_NOK}

4. Fail deploy application with full arguments and Host is empty
                      NOK                                                                                   ${SAR_LOCATION}    YES          YES              ${CONFIG_PLAN}    ${EMPTY}     ${_WL_HOME}    ${EMPTY}       ${PROTOCOL}    2              ${ENDED_NOK}

*** Keywords ***
Deploy Application Template
    [Arguments]    ${ok_nok}    ${sar}    ${overwrite}    ${force}    ${config}    ${partition}
    ...    ${oracle_home}    ${host}    ${protocol}    ${returnCode}    ${returnStatus}
    [Documentation]    This template is used for test DEPLOY_APPLICATION with needed arguments
    ...    - ${OK_NOK}: boolean value indicate if the runbook(action) should be ENDED_OK or ENDED_NOT_OK. value of this variable should be OK or NOK.
    ...    - ${host}: IP or hostname of the WebLogic Server
    ...    - ${port}: Port number used to connect to the WebLogic SOA Server
    ...    - ${user}: Username used to authenticate with WebLogic
    ...    - ${pass}: Password used to authenticate with WebLogic
    ...    - ${protocol}: Select connection protocol to connect WLST to server
    ...    - ${sar}: Absolute path to a specified SAR file or to all SAR files included in the ZIP file.
    ...    - ${overwrite}: Indicates whether to overwrite an existing SOA composite application file. false (default): Does not overwrite the file. true: Overwrites the file.
    ...    - ${force}: Indicates whether to set the new composite as the default. true (default): Makes it the default composite. false: Does not make it the default composite.
    ...    - ${config}: Absolute path of a configuration plan to be applied to a specified SAR file or to all SAR files included in the ZIP file.
    ...    - ${partition}: string value indicate partition of activated application
    ...    - ${oracle_home}: string value indicate Oracle Home in target machine
    ...    - ${retcode}: expected return code after execute action(runbook)
    ...    - ${status}: expected return status after execute action(runbook)
    Init Action    ${ACTION_DEPLOY_APPLICATION}
    Set Default Weblogic Server Connection
    Action Set    ${PRT_DEPLOY_APPLICATION_SAR}    ${sar}
    Action Set    ${PRT_DEPLOY_APPLICATION_OVERWRITE}    ${overwrite}
    Action Set    ${PRT_DEPLOY_APPLICATION_FORCE}    ${force}
    Action Set    ${PRT_DEPLOY_APPLICATION_CONFIG}    ${config}
    Action Set    ${PRT_DEPLOY_APPLICATION_PARTITION}    ${partition}
    Action Set    ${PRT_DEPLOY_APPLICATION_ORACLE_HOME}    ${oracle_home}
    Action Set    ${PRT_WEBLOGIC_HOST}    ${host}
    Action Set    ${PRT_WEBLOGIC_USE_PROTOCOL}    ${protocol}
    Action Set Timeout    300
    Action Execute
    Action Report Should Be Found
    Action Return Code Should Be    ${returnCode}
    Action Return Status Should Be    ${returnStatus}
    Action Report Should Contain    ${header_logging}
    Action Report Should Contain    ${param_logging}
    Run Keyword If    '${OK_NOK}'=='OK'    Action Report Should Contain    ${execution_logging}
    Run Keyword If    '${OK_NOK}'=='OK'    Action Report Should Contain    ${footer_logging_OK}

Setup_suite
    [Documentation]    TODO: Write all steps need prepare before testing here
    Log    Start testing for Deploy Application Template

Teardown_suite
    [Documentation]    TODO: Write all steps for cleanup after testing here
    Log    Testing for Deploy Application Template end
